

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>dataloader.py &mdash; Inverse Variance Weighting Update 2020 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'2020',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="loss.py" href="losses.html" />
    <link rel="prev" title="Welcome to Inverse Variance Weighting Update’s documentation!" href="../index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Inverse Variance Weighting Update
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">dataloader.py</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#utkface">UTKFace</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="losses.html">loss.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">models.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="params.html">params.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="train.html">train.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils.py</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Inverse Variance Weighting Update</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>dataloader.py</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/pages/dataloader.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dataloader-py">
<h1>dataloader.py<a class="headerlink" href="#dataloader-py" title="Permalink to this headline">¶</a></h1>
<div class="section" id="utkface">
<h2>UTKFace<a class="headerlink" href="#utkface" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="dataloader.UTKface">
<em class="property">class </em><code class="descclassname">dataloader.</code><code class="descname">UTKface</code><span class="sig-paren">(</span><em>path</em>, <em>train=True</em>, <em>transform=None</em>, <em>noise=False</em>, <em>noise_type=None</em>, <em>uniform_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dataloader.UTKface" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Description:</dt>
<dd>UTKFace dataset is a large-scale face dataset with long age span (range from 0 to 116 years old). 
The dataset consists of over 20,000 face images with annotations of age, gender, and ethnicity. 
The images cover large variation in pose, facial expression, illumination, occlusion, resolution, etc.</dd>
<dt>Args:</dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">train (bool):</th><td class="field-body">Controls if the data will include the noise and its varaince with the actual inputs and labels or not.</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">train_size (int):</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body">Controls the number of samples in the training set.</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">images_path (string):</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">Dataset directory path.</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">transform (Object):</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body">A torchvision transofrmer for processing the images.</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">noise_type (string):</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">Controls the type of noise that will be added to the data</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">dist_data (tuple):</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body">A tuple of the mean and the variance of the noise distribution.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<dl class="method">
<dt id="dataloader.UTKface.get_unif_bounds">
<code class="descname">get_unif_bounds</code><span class="sig-paren">(</span><em>mu</em>, <em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#dataloader.UTKface.get_unif_bounds" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Description:</dt>
<dd><p class="first">Generates the bounds of the uniform distribution by solving the formula</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">v</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Return:</dt>
<dd>Uniform distribution bounds a and b.</dd>
<dt>Return type:</dt>
<dd>Tuple.</dd>
<dt>Args:</dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">mu (float):</th><td class="field-body">mean.</td>
</tr>
<tr class="field-even field"><th class="field-name">v  (float):</th><td class="field-body">variance.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dataloader.UTKface.get_gamma_params">
<code class="descname">get_gamma_params</code><span class="sig-paren">(</span><em>mu</em>, <em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#dataloader.UTKface.get_gamma_params" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Description:</dt>
<dd><p class="first">Generates the shape or concentration (alpha) and rate (beta) using the mean and variance of gamma distribution</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">k</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">theta</span>
<span class="o">**</span>
<span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">v</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">v</span><span class="o">/</span><span class="n">mu</span>
</pre></div>
</div>
</dd>
<dt>Return:</dt>
<dd>Alpha and Beta of gamma distribution.</dd>
<dt>Return type:</dt>
<dd>Tuple.</dd>
<dt>Args:</dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">mu (float):</th><td class="field-body">mean.</td>
</tr>
<tr class="field-even field"><th class="field-name">v  (float):</th><td class="field-body">variance.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dataloader.UTKface.get_distribution">
<code class="descname">get_distribution</code><span class="sig-paren">(</span><em>dist_type</em>, <em>mu</em>, <em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#dataloader.UTKface.get_distribution" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Description:</dt>
<dd>Create a distribution function from specified family by dist_type argument (uniform or gamma).</dd>
<dt>Return:</dt>
<dd>A distribution function.</dd>
<dt>Return type:</dt>
<dd>Object.</dd>
<dt>Args:</dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">std_dist(function):</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">a distribution function for sampling the noises variances.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dataloader.UTKface.gaussian_noise">
<code class="descname">gaussian_noise</code><span class="sig-paren">(</span><em>std_dist</em><span class="sig-paren">)</span><a class="headerlink" href="#dataloader.UTKface.gaussian_noise" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Description:</dt>
<dd>Generates gaussian noises with mean 0 and heteroscedasticitical variance that sampled from one of a range of distributions (uniform or gamma).</dd>
<dt>Return:</dt>
<dd>Guassian noises and their heteroscedasticitical variances.</dd>
<dt>Return type:</dt>
<dd>Tuple.</dd>
<dt>Args:</dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">std_dist(object):</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">a distribution function for sampling the noises variances.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dataloader.UTKface.generate_noise">
<code class="descname">generate_noise</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dataloader.UTKface.generate_noise" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Description:</dt>
<dd>Generates noises.</dd>
<dt>Return:</dt>
<dd>Guassian noises and their heteroscedasticitical variances.</dd>
<dt>Return type:</dt>
<dd>Tuple.</dd>
<dt>Args:</dt>
<dd>None.</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="losses.html" class="btn btn-neutral float-right" title="loss.py" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral float-left" title="Welcome to Inverse Variance Weighting Update’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Waleed Khamies

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>